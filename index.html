<!DOCTYPE html>
<html lang="th">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
Â  <title>Dashboard à¸ªà¸–à¸²à¸™à¸°à¸„à¸”à¸µà¸›à¸à¸„à¸£à¸­à¸‡</title>
Â  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
Â  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
Â  <style>
Â  Â  /* à¹ƒà¸Šà¹‰ Tailwind/Custom CSS à¸ªà¸³à¸«à¸£à¸±à¸šà¸„à¸§à¸²à¸¡à¸ªà¸§à¸¢à¸‡à¸²à¸¡à¹à¸¥à¸°à¸à¸²à¸£à¸›à¸£à¸±à¸šà¸•à¸²à¸¡à¸­à¸¸à¸›à¸à¸£à¸“à¹Œ */
Â  Â  body {
Â  Â  Â  font-family: "Sarabun", sans-serif;
Â  Â  Â  background-color: #f7f9fb;
Â  Â  Â  margin: 0;
Â  Â  Â  padding: 10px;
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  align-items: center;
Â  Â  }
Â  Â  .container {
Â  Â  Â  max-width: 1200px;
Â  Â  Â  width: 100%;
Â  Â  Â  padding: 10px;
Â  Â  }
Â  Â  h1 {
Â  Â  Â  color: #1b365d;
Â  Â  Â  text-align: center;
Â  Â  Â  margin-bottom: 25px;
Â  Â  Â  font-size: 1.8rem;
Â  Â  }
Â  Â  .dashboard {
Â  Â  Â  display: grid;
Â  Â  Â  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));Â 
Â  Â  Â  gap: 12px;
Â  Â  Â  margin-bottom: 25px;
Â  Â  }
Â  Â  .card {
Â  Â  Â  background: white;
Â  Â  Â  padding: 15px;
Â  Â  Â  border-radius: 12px;
Â  Â  Â  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
Â  Â  Â  text-align: center;
Â  Â  Â  border-left: 6px solid;Â 
Â  Â  Â  transition: transform 0.2s;
Â  Â  }
Â  Â  .card:hover {
Â  Â  Â  transform: translateY(-3px);
Â  Â  }
Â  Â  
Â  Â  /* à¸ªà¸µ Border à¸•à¸²à¸¡à¸ªà¸–à¸²à¸™à¸° */
Â  Â  #totalCasesCard { border-color: #1b365d; }
Â  Â  #firstCourtCasesCard { border-color: #2196F3; }
Â  Â  #supremeCourtCasesCard { border-color: #FFC107; }
Â  Â  #finalJudgementCasesCard { border-color: #4CAF50; }
Â  Â  #enforcementInProgressCasesCard { border-color: #FF9800; }
Â  Â  #enforcementCompleteCasesCard { border-color: #009688; }

Â  Â  .card h3 {
Â  Â  Â  font-size: 0.85em;
Â  Â  Â  margin: 0 0 5px;
Â  Â  Â  color: #6b7280; /* Gray-500 */
Â  Â  }
Â  Â  .card h2 {
Â  Â  Â  font-size: 1.7em;
Â  Â  Â  margin: 5px 0;
Â  Â  Â  color: #1b365d;
Â  Â  Â  font-weight: 700;
Â  Â  }
Â  Â  .chart-container {
Â  Â  Â  background: white;
Â  Â  Â  padding: 20px;
Â  Â  Â  border-radius: 12px;
Â  Â  Â  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
Â  Â  Â  margin-bottom: 30px;
Â  Â  }
Â  Â  h2 {
Â  Â  Â  color: #1b365d;
Â  Â  Â  margin-top: 0;
Â  Â  Â  font-size: 1.5rem;
Â  Â  Â  border-bottom: 2px solid #e5e7eb;
Â  Â  Â  padding-bottom: 5px;
Â  Â  Â  margin-bottom: 15px;
Â  Â  }
Â  Â  table {
Â  Â  Â  width: 100%;
Â  Â  Â  border-collapse: collapse;
Â  Â  Â  background: white;
Â  Â  Â  border-radius: 12px;
Â  Â  Â  overflow: hidden;
Â  Â  Â  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
Â  Â  }
Â  Â  th, td {
Â  Â  Â  padding: 12px 10px;
Â  Â  Â  border-bottom: 1px solid #eee;
Â  Â  Â  text-align: left;
Â  Â  Â  font-size: 0.9em;
Â  Â  }
Â  Â  th {
Â  Â  Â  background: #1b365d;
Â  Â  Â  color: white;
Â  Â  Â  font-weight: 700;
Â  Â  }
Â  Â  tbody tr:hover {
Â  Â  Â  Â  background-color: #f0f4f8;
Â  Â  }
Â  Â  .error-box {
Â  Â  Â  Â  background-color: #fee2e2;
Â  Â  Â  Â  color: #b91c1c;
Â  Â  Â  Â  border: 1px solid #fca5a5;
Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  font-weight: bold;
Â  Â  }

Â  Â  /* Mobile Responsiveness */
Â  Â  @media (max-width: 600px) {
Â  Â  Â  Â  .dashboard {
Â  Â  Â  Â  Â  Â  grid-template-columns: repeat(2, 1fr);
Â  Â  Â  Â  }
Â  Â  Â  Â  h1 {
Â  Â  Â  Â  Â  Â  font-size: 1.5rem;
Â  Â  Â  Â  }
Â  Â  Â  Â  th, td {
Â  Â  Â  Â  Â  Â  padding: 8px 5px;
Â  Â  Â  Â  Â  Â  font-size: 0.8em;
Â  Â  Â  Â  }
Â  Â  }
Â  </style>
</head>
<body>
Â  <div class="container">
Â  Â  <h1>ğŸ“Š à¸£à¸°à¸šà¸šà¸•à¸´à¸”à¸•à¸²à¸¡à¸ªà¸–à¸²à¸™à¸°à¸„à¸”à¸µà¸›à¸à¸„à¸£à¸­à¸‡</h1>
Â  Â  <div id="statusMessage"></div> <!-- à¹ƒà¸Šà¹‰à¹à¸ªà¸”à¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™/à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸” -->

Â  Â  <div class="dashboard">
Â  Â  Â  <div class="card" id="totalCasesCard">
Â  Â  Â  Â  <h3>à¸„à¸”à¸µà¸£à¸§à¸¡à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”</h3>
Â  Â  Â  Â  <h2 id="totalCases">-</h2>
Â  Â  Â  </div>
Â  Â  Â  <div class="card" id="firstCourtCasesCard">
Â  Â  Â  Â  <h3>à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡à¸à¸´à¸ˆà¸²à¸£à¸“à¸² (à¸¨à¸²à¸¥à¸Šà¸±à¹‰à¸™à¸•à¹‰à¸™)</h3>
Â  Â  Â  Â  <h2 id="firstCourtCases">-</h2>
Â  Â  Â  </div>
Â  Â  Â  <div class="card" id="supremeCourtCasesCard">
Â  Â  Â  Â  <h3>à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡à¸à¸´à¸ˆà¸²à¸£à¸“à¸² (à¸¨à¸²à¸¥à¸ªà¸¹à¸‡à¸ªà¸¸à¸”)</h3>
Â  Â  Â  Â  <h2 id="supremeCourtCases">-</h2>
Â  Â  Â  </div>
Â  Â  Â  <div class="card" id="finalJudgementCasesCard">
Â  Â  Â  Â  <h3>à¸„à¸³à¸à¸´à¸à¸²à¸à¸©à¸²à¸–à¸¶à¸‡à¸—à¸µà¹ˆà¸ªà¸¸à¸”à¹à¸¥à¹‰à¸§</h3>
Â  Â  Â  Â  <h2 id="finalJudgementCases">-</h2>
Â  Â  Â  </div>
Â  Â  Â  <div class="card" id="enforcementInProgressCasesCard">
Â  Â  Â  Â  <h3>à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¸šà¸±à¸‡à¸„à¸±à¸šà¸„à¸”à¸µ</h3>
Â  Â  Â  Â  <h2 id="enforcementInProgressCases">-</h2>
Â  Â  Â  </div>
Â  Â  Â  <div class="card" id="enforcementCompleteCasesCard">
Â  Â  Â  Â  <h3>à¸šà¸±à¸‡à¸„à¸±à¸šà¸„à¸”à¸µà¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸´à¹‰à¸™</h3>
Â  Â  Â  Â  <h2 id="enforcementCompleteCases">-</h2>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="chart-container">
Â  Â  Â  <h2>à¸ªà¸£à¸¸à¸›à¸ªà¸–à¸²à¸™à¸°à¸„à¸”à¸µ</h2>
Â  Â  Â  <canvas id="caseStatusChart"></canvas>
Â  Â  </div>

Â  Â  <h2>ğŸ“ à¸£à¸²à¸¢à¸à¸²à¸£à¸„à¸”à¸µà¸¥à¹ˆà¸²à¸ªà¸¸à¸” (10 à¸„à¸”à¸µ)</h2>
Â  Â  <div style="overflow-x: auto;">
Â  Â  Â  <table id="casesTable">
Â  Â  Â  Â  <thead>
Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  <th>à¹€à¸¥à¸‚à¸„à¸”à¸µà¸”à¸³</th>
Â  Â  Â  Â  Â  Â  <th>à¸¨à¸²à¸¥</th>
Â  Â  Â  Â  Â  Â  <th>à¸œà¸¹à¹‰à¸Ÿà¹‰à¸­à¸‡à¸„à¸”à¸µ</th>
Â  Â  Â  Â  Â  Â  <th>à¸ªà¸–à¸²à¸™à¸°à¸„à¸”à¸µ</th>
Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  </thead>
Â  Â  Â  Â  <tbody></tbody>
Â  Â  Â  </table>
Â  Â  </div>
Â  </div>

Â  <script>
Â  Â  // **********************************************
Â  Â  // âš ï¸ à¸à¸³à¸«à¸™à¸”à¸„à¹ˆà¸² Google Sheet API âš ï¸
Â  Â  // **********************************************
Â  Â  // 1. **SHEET ID**: ID à¸‚à¸­à¸‡ Google Sheet (à¸ˆà¸²à¸ URL)
Â  Â  const sheetId = "wewin-case";Â  // à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸‚à¸­à¸‡à¸„à¸¸à¸“
Â  Â Â 
Â  Â  // 2. **API KEY**: Google Cloud API Key (à¸•à¹‰à¸­à¸‡à¹€à¸›à¸´à¸” Sheets API à¹à¸¥à¸°à¸­à¸™à¸¸à¸à¸²à¸• Referrer)
Â  Â  const API_KEY_PLACEHOLDER = "AIzaSyCPsgQyhXD28bNQOu-sKPaXxzdoPlyTXHw";
Â  Â  // âš ï¸ à¸à¸£à¸¸à¸“à¸²à¹à¸—à¸™à¸—à¸µà¹ˆ YOUR_API_KEY_HERE à¸”à¹‰à¸§à¸¢à¸„à¸µà¸¢à¹Œà¸ˆà¸£à¸´à¸‡à¸‚à¸­à¸‡à¸„à¸¸à¸“ âš ï¸
Â  Â  const apiKey = API_KEY_PLACEHOLDER; 
Â  Â Â 
Â  Â  // 3. **Range**: à¸Šà¹ˆà¸§à¸‡à¸‚à¸­à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ (à¹ƒà¸Šà¹‰ A:M à¹€à¸à¸·à¹ˆà¸­à¸„à¸£à¸­à¸šà¸„à¸¥à¸¸à¸¡à¸—à¸±à¹‰à¸‡à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œ)
Â  Â  const range = "A:M";
Â  Â Â 
Â  Â  // 4. à¸Šà¸·à¹ˆà¸­ Sheet: à¸•à¹‰à¸­à¸‡à¸•à¸£à¸‡à¸à¸±à¸šà¸Šà¸·à¹ˆà¸­à¸Šà¸µà¸•à¹ƒà¸™à¹„à¸Ÿà¸¥à¹Œ Google Sheet (à¸„à¹ˆà¸²à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™à¸„à¸·à¸­ Sheet1)
Â  Â  const sheetName = "Sheet1";Â 
Â  Â  
Â  Â  // URL à¸ªà¸³à¸«à¸£à¸±à¸šà¹€à¸£à¸µà¸¢à¸ Google Sheets API
Â  Â  const sheetUrl = `https://sheets.googleapis.com/v4/spreadsheets/${wewin-case}/values/${"à¸à¸²à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸–à¸²à¸™à¸°à¸„à¸”à¸µà¸›à¸à¸„à¸£à¸­à¸‡"}!${A:M}?key=${AIzaSyCPsgQyhXD28bNQOu-sKPaXxzdoPlyTXHw}`;

Â  Â  // à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¹à¸ªà¸”à¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸œà¸´à¸”à¸à¸¥à¸²à¸”à¸šà¸™ UI
Â  Â  const displayError = (message) => {
Â  Â  Â  Â  document.getElementById("statusMessage").innerHTML = `<div class="error-box">âš ï¸ ${message} </div>`;
Â  Â  Â  Â  // à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸à¸²à¸£à¹Œà¸”à¹€à¸›à¹‡à¸™ Error
Â  Â  Â  Â  document.getElementById("totalCases").innerText = "---";
Â  Â  }

Â  Â  // à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š API Key Placeholder
Â  Â  if (apiKey === API_KEY_PLACEHOLDER) {
Â  Â  Â  Â  displayError("à¸à¸£à¸¸à¸“à¸²à¹à¸—à¸™à¸—à¸µà¹ˆ 'YOUR_API_KEY_HERE' à¸”à¹‰à¸§à¸¢ API Key à¸ˆà¸£à¸´à¸‡à¸‚à¸­à¸‡à¸„à¸¸à¸“");
Â  Â  } else {
Â  Â  Â  Â  fetchDataAndRenderDashboard();
Â  Â  }

Â  Â  // à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸«à¸¥à¸±à¸à¹ƒà¸™à¸à¸²à¸£à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸¥à¸°à¹à¸ªà¸”à¸‡à¸œà¸¥
Â  Â  function fetchDataAndRenderDashboard() {
Â  Â  Â  Â  // console.log("Attempting to fetch data from URL:", sheetUrl);

Â  Â  Â  Â  // à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸ªà¸³à¸«à¸£à¸±à¸šà¸„à¸³à¸™à¸§à¸“à¸ªà¸£à¸¸à¸›à¸‚à¹‰à¸­à¸¡à¸¹à¸¥
Â  Â  Â  Â  const calculateCaseSummary = (cases) => {
Â  Â  Â  Â  Â  Â  const statusMap = {
Â  Â  Â  Â  Â  Â  Â  Â  // à¹ƒà¸Šà¹‰ toUpperCase() à¹€à¸à¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸¡à¸±à¹ˆà¸™à¹ƒà¸ˆà¹ƒà¸™à¸à¸²à¸£à¹€à¸›à¸£à¸µà¸¢à¸šà¹€à¸—à¸µà¸¢à¸š
Â  Â  Â  Â  Â  Â  Â  Â  firstCourtCases: (status) => status && status.includes("à¸Šà¸±à¹‰à¸™à¸•à¹‰à¸™") && !status.includes("à¸ªà¸¹à¸‡à¸ªà¸¸à¸”") && !status.includes("à¸–à¸¶à¸‡à¸—à¸µà¹ˆà¸ªà¸¸à¸”"),
Â  Â  Â  Â  Â  Â  Â  Â  supremeCourtCases: (status) => status && status.includes("à¸ªà¸¹à¸‡à¸ªà¸¸à¸”") && !status.includes("à¸–à¸¶à¸‡à¸—à¸µà¹ˆà¸ªà¸¸à¸”") && !status.includes("à¸šà¸±à¸‡à¸„à¸±à¸šà¸„à¸”à¸µ"),
Â  Â  Â  Â  Â  Â  Â  Â  finalJudgementCases: (status) => status && status.includes("à¸–à¸¶à¸‡à¸—à¸µà¹ˆà¸ªà¸¸à¸”") && !status.includes("à¸šà¸±à¸‡à¸„à¸±à¸šà¸„à¸”à¸µ"),
Â  Â  Â  Â  Â  Â  Â  Â  enforcementInProgressCases: (status) => status && status.includes("à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡à¸šà¸±à¸‡à¸„à¸±à¸šà¸„à¸”à¸µ") && !status.includes("à¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸´à¹‰à¸™"),
Â  Â  Â  Â  Â  Â  Â  Â  enforcementCompleteCases: (status) => status && status.includes("à¸šà¸±à¸‡à¸„à¸±à¸šà¸„à¸”à¸µà¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸´à¹‰à¸™")
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  const summary = { totalCases: cases.length };

Â  Â  Â  Â  Â  Â  for (const key in statusMap) {
Â  Â  Â  Â  Â  Â  Â  Â  summary[key] = cases.filter(c => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const status = c["à¸ªà¸–à¸²à¸™à¸°à¸„à¸”à¸µ"] ? c["à¸ªà¸–à¸²à¸™à¸°à¸„à¸”à¸µ"].toLowerCase() : "";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return statusMap[key](status);
Â  Â  Â  Â  Â  Â  Â  Â  }).length;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  return summary;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸­à¸±à¸›à¹€à¸”à¸• Dashboard (KPI Cards)
Â  Â  Â  Â  const updateDashboard = (summary) => {
Â  Â  Â  Â  Â  Â  document.getElementById("totalCases").innerText = summary.totalCases;
Â  Â  Â  Â  Â  Â  document.getElementById("firstCourtCases").innerText = summary.firstCourtCases;
Â  Â  Â  Â  Â  Â  document.getElementById("supremeCourtCases").innerText = summary.supremeCourtCases;
Â  Â  Â  Â  Â  Â  document.getElementById("finalJudgementCases").innerText = summary.finalJudgementCases;
Â  Â  Â  Â  Â  Â  document.getElementById("enforcementInProgressCases").innerText = summary.enforcementInProgressCases;
Â  Â  Â  Â  Â  Â  document.getElementById("enforcementCompleteCases").innerText = summary.enforcementCompleteCases;
Â  Â  Â  Â  }

Â  Â  Â  Â  // à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¹à¸ªà¸”à¸‡à¸à¸£à¸²à¸Ÿ
Â  Â  Â  Â  const renderChart = (summary) => {
Â  Â  Â  Â  Â  Â  const ctx = document.getElementById("caseStatusChart");
Â  Â  Â  Â  Â  Â  const chartData = {
Â  Â  Â  Â  Â  Â  Â  labels: ["à¸à¸´à¸ˆà¸²à¸£à¸“à¸² (à¸Šà¸±à¹‰à¸™à¸•à¹‰à¸™)", "à¸à¸´à¸ˆà¸²à¸£à¸“à¸² (à¸ªà¸¹à¸‡à¸ªà¸¸à¸”)", "à¸–à¸¶à¸‡à¸—à¸µà¹ˆà¸ªà¸¸à¸”à¹à¸¥à¹‰à¸§", "à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡à¸šà¸±à¸‡à¸„à¸±à¸šà¸„à¸”à¸µ", "à¸šà¸±à¸‡à¸„à¸±à¸šà¸„à¸”à¸µà¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸´à¹‰à¸™"],
Â  Â  Â  Â  Â  Â  Â  datasets: [{
Â  Â  Â  Â  Â  Â  Â  Â  label: "à¸ˆà¸³à¸™à¸§à¸™à¸„à¸”à¸µ",
Â  Â  Â  Â  Â  Â  Â  Â  data: [
Â  Â  Â  Â  Â  Â  Â  Â  Â  summary.firstCourtCases,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  summary.supremeCourtCases,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  summary.finalJudgementCases,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  summary.enforcementInProgressCases,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  summary.enforcementCompleteCases
Â  Â  Â  Â  Â  Â  Â  Â  ],
Â  Â  Â  Â  Â  Â  Â  Â  backgroundColor: ["#2196F3", "#FFC107", "#4CAF50", "#FF9800", "#009688"]
Â  Â  Â  Â  Â  Â  Â  }]
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (window.caseStatusChart) {
Â  Â  Â  Â  Â  Â  Â  Â  window.caseStatusChart.destroy();Â 
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  window.caseStatusChart = new Chart(ctx, {
Â  Â  Â  Â  Â  Â  Â  type: "bar",
Â  Â  Â  Â  Â  Â  Â  data: chartData,
Â  Â  Â  Â  Â  Â  Â  options: {Â 
Â  Â  Â  Â  Â  Â  Â  Â  responsive: true,Â 
Â  Â  Â  Â  Â  Â  Â  Â  plugins: { legend: { display: false } },
Â  Â  Â  Â  Â  Â  Â  Â  scales: { y: { beginAtZero: true, ticks: { precision: 0 } } }
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  // à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥
Â  Â  Â  Â  fetch(sheetUrl)
Â  Â  Â  Â  Â  .then(res => {
Â  Â  Â  Â  Â  Â  if (!res.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  // à¸­à¹ˆà¸²à¸™à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸œà¸´à¸”à¸à¸¥à¸²à¸”à¸ˆà¸²à¸ body à¹€à¸à¸·à¹ˆà¸­à¹ƒà¸«à¹‰à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¸‚à¸¶à¹‰à¸™
Â  Â  Â  Â  Â  Â  Â  Â  return res.json().then(error => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const errorMessage = error.error?.message || `HTTP Status: ${res.status}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error(errorMessage);
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  return res.json();
Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  .then(data => {
Â  Â  Â  Â  Â  Â  const rows = data.values;
Â  Â  Â  Â  Â  Â  if (!rows || rows.length < 2) {
Â  Â  Â  Â  Â  Â  Â  Â  displayError("à¹„à¸¡à¹ˆà¸à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ à¸«à¸£à¸·à¸­à¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹„à¸¡à¹ˆà¹€à¸à¸µà¸¢à¸‡à¸à¸­ à¹‚à¸›à¸£à¸”à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸Šà¹ˆà¸§à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ (Range)");
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  if (!rows[0].includes("à¸ªà¸–à¸²à¸™à¸°à¸„à¸”à¸µ") || !rows[0].includes("à¹€à¸¥à¸‚à¸„à¸”à¸µà¸”à¸³")) {
Â  Â  Â  Â  Â  Â  Â  Â  displayError("à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸œà¸´à¸”à¸à¸¥à¸²à¸”: à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¸¡à¸µà¸«à¸±à¸§à¸‚à¹‰à¸­ 'à¸ªà¸–à¸²à¸™à¸°à¸„à¸”à¸µ', 'à¹€à¸¥à¸‚à¸„à¸”à¸µà¸”à¸³' à¹ƒà¸™à¹à¸–à¸§à¹à¸£à¸");
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const headers = rows[0];
Â  Â  Â  Â  Â  Â  // à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸Šà¸·à¹ˆà¸­à¸•à¸±à¸§à¹à¸›à¸£ 'cases' à¹€à¸›à¹‡à¸™ 'caseRecords' à¹€à¸à¸·à¹ˆà¸­à¸«à¸¥à¸µà¸à¹€à¸¥à¸µà¹ˆà¸¢à¸‡ Syntax Error 'Unexpected token case'
Â  Â  Â  Â  Â  Â  const caseRecords = rows.slice(1)
Â  Â  Â  Â  Â  Â  Â  .filter(r => r.some(cell => cell)) // à¸à¸£à¸­à¸‡à¹à¸–à¸§à¸—à¸µà¹ˆà¸§à¹ˆà¸²à¸‡à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
Â  Â  Â  Â  Â  Â  Â  .map(r => Object.fromEntries(headers.map((h, i) => [h, r[i]])));
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const caseSummary = calculateCaseSummary(caseRecords);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  updateDashboard(caseSummary);
Â  Â  Â  Â  Â  Â  renderChart(caseSummary);

Â  Â  Â  Â  Â  Â  // à¸•à¸²à¸£à¸²à¸‡à¸„à¸”à¸µà¸¥à¹ˆà¸²à¸ªà¸¸à¸” (10 à¸„à¸”à¸µà¸ªà¸¸à¸”à¸—à¹‰à¸²à¸¢)
Â  Â  Â  Â  Â  Â  const tbody = document.querySelector("#casesTable tbody");
Â  Â  Â  Â  Â  Â  tbody.innerHTML = "";
Â  Â  Â  Â  Â  Â  caseRecords.slice(-10).reverse().forEach(c => {
Â  Â  Â  Â  Â  Â  Â  const row = `<tr>
Â  Â  Â  Â  Â  Â  Â  Â  <td>${c["à¹€à¸¥à¸‚à¸„à¸”à¸µà¸”à¸³"] || "-"}</td>
Â  Â  Â  Â  Â  Â  Â  Â  <td>${c["à¸¨à¸²à¸¥"] || "-"}</td>
Â  Â  Â  Â  Â  Â  Â  Â  <td>${c["à¸œà¸¹à¹‰à¸Ÿà¹‰à¸­à¸‡à¸„à¸”à¸µ"] || "-"}</td>
Â  Â  Â  Â  Â  Â  Â  Â  <td>${c["à¸ªà¸–à¸²à¸™à¸°à¸„à¸”à¸µ"] || "-"}</td>
Â  Â  Â  Â  Â  Â  Â  </tr>`;
Â  Â  Â  Â  Â  Â  Â  tbody.insertAdjacentHTML("beforeend", row);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  .catch(err => {
Â  Â  Â  Â  Â  Â  Â  console.error("Fetch Data Failed:", err);
Â  Â  Â  Â  Â  Â  Â  displayError(`à¸à¸²à¸£à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§: ${err.message}. à¹‚à¸›à¸£à¸”à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š Console Log (F12) à¹€à¸à¸·à¹ˆà¸­à¸”à¸¹à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”`);
Â  Â  Â  Â  Â  });
Â  Â  }
Â  </script>
</body>
</html>
